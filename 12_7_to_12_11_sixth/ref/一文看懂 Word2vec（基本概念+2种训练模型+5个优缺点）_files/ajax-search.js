!function(e){"use strict";e(document).ready(function(){function s(e,s,i){i=i.trim(),i.length>1&&(clearTimeout(e.data("ajax-search-timer")),e.data("ajax-search-timer",setTimeout(function(){e.addClass("m-loading"),null!=t&&t.abort(),t=jQuery.ajax({type:"post",url:lsvr_lore_ajax_search_var.url,data:"action=lsvr-lore-ajax-search&nonce="+lsvr_lore_ajax_search_var.nonce+"&post_type="+s+"&search_query="+i,success:function(s){if(""!==s){var t=!1;try{t=JSON.parse(s)}catch(i){log("Lore Ajax Search Response: INVALID JSON")}t&&a(e,t)}else log("Lore Ajax Search Response: BLANK");e.removeClass("m-loading")},error:function(){e.removeClass("m-loading"),log("Lore Ajax Search Response: ERROR")}})},500)))}function a(s,a){if(a.hasOwnProperty("status")){var t=a.status,i=(s.find(".text-input"),"");if("ok"===t&&a.hasOwnProperty("results"))e.each(a.results,function(){var e="";this.hasOwnProperty("post_title")&&this.hasOwnProperty("icon_class")&&this.hasOwnProperty("permalink")&&this.hasOwnProperty("post_type")&&(i+='<li><a href="'+this.permalink+'" class="m-post-type-'+this.post_type+'">',i+='<i class="ico '+this.icon_class+'"></i>'+this.post_title,(this.hasOwnProperty("likes")||this.hasOwnProperty("dislikes")||this.hasOwnProperty("difference"))&&(this.hasOwnProperty("likes")&&(e+='<span class="likes">'+this.likes+"</span>"),this.hasOwnProperty("dislikes")&&(e+='<span class="dislikes">'+this.dislikes+"</span>"),this.hasOwnProperty("difference")&&this.hasOwnProperty("difference_abb")&&(e+=this.difference<0?'<span class="dislikes difference">':'<span class="likes difference">',e+=this.difference_abb+"</span>"),""!==e&&(i+='<span class="c-post-rating">'+e+"</span>")),i+="</a></li>")}),i='<ul class="results-list">'+i+"</ul>",a.hasOwnProperty("more_label")&&a.hasOwnProperty("more_link")&&(i+='<p class="more-link"><a href="'+a.more_link+'">'+a.more_label+"</a></p>");else if("noresults"===t){var r=a.hasOwnProperty("message")?a.message:"";""!==r&&(i='<p class="results-message">'+r+"</p>")}""!==i&&(s.find(".header-search-results").length>0?s.find(".header-search-results").first().html(i):s.find(".header-search-options").append('<div class="header-search-results">'+i+"</div>"),s.find(".header-search-results").is(":hidden")&&s.find(".header-search-results").slideDown(300))}}e(".header-search-form.m-ajaxed").each(function(){var a,t=e(this),i=t.find(".text-input"),r=t.find(".header-search-filter"),n="",l=[];r.find("input:checked").each(function(){l.push(e(this).val())}),a=l.length<1?"any":l.join(),l=[],i.on("change keyup paste",function(i){var r=e(this).val();r!==n&&38!==i.which&&40!==i.which&&13!==i.which&&(n=r.trim(),s(t,a,n))}),i.on("focus",function(i){var r=e(this).val();r===n&&t.find(".header-search-results").length>0?t.find(".header-search-results").slideDown(300):(n=r.trim(),s(t,a,n))}),r.find('input[type="checkbox"]').on("change",function(){r.find("input:checked").each(function(){l.push(e(this).val())}),a=l.length<1?"any":l.join(),l=[],s(t,a,n)}),i.on("keydown",function(e){var s=t.find(".header-search-results"),a=s.find(".m-active");40===e.which&&(a.length<1||a.filter(":last-child").length?(a.removeClass("m-active"),s.find("ul > li:first-child").addClass("m-active")):(a.removeClass("m-active"),a.next().addClass("m-active")),e.preventDefault(),e.stopPropagation()),38===e.which&&(a.length<1||a.filter(":first-child").length?(a.removeClass("m-active"),s.find("ul > li:last-child").addClass("m-active")):(a.removeClass("m-active"),a.prev().addClass("m-active")),e.preventDefault(),e.stopPropagation()),13===e.which&&a.length&&(window.location.href=a.find("a").attr("href"),e.preventDefault(),e.stopPropagation())})});var t})}(jQuery);